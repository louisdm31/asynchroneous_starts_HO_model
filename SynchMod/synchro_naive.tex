
\documentclass{article}
\usepackage{amsmath}
\usepackage[noend]{libHO/distribalgo}
\usepackage{algorithm}
\usepackage{amssymb}
\usepackage{listings}
\usepackage{amsthm}
\usepackage{dsfont}
\usepackage{stmaryrd}
\usepackage[left=2cm, right=2cm, top=2cm]{geometry}
\usepackage[utf8]{inputenc}


\newtheorem{lemma}{Lemma}[section]
\newtheorem{theorem}{Theorem}
\newtheorem{definition}{Definition}
\usepackage{biblatex}
\addbibresource{rapport.bib}

\title{Naive synchronization algorithm}
\date{August 2020}
\author{Louis Penet de Monterno - Bernadette Charron-Bost}

\begin{document}

Our goal is to solve the non-uniform synchronization problem, defined below.
We consider a system composed of a set of $\Pi$ nodes.
A subset $S \subseteq \Pi$ is the subset of correct nodes.
A correct node never crash, and any messages sent by $u \in S$ always reach their destination.
An incorrect node $u \in \Pi \setminus S$ which crashes in rount $t$ must :
\begin{itemize}
	\item be correct until round $t-1$. All of its outgoing messages reach their destination.
	\item fail in round $t$ : only a subset of its outgoing messages reach their destination.
	\item be quiet in round $t+1$ and later.
\end{itemize}



\begin{algorithm}[htb]\label{algo:code}
\begin{distribalgo}[1]
\BLANK \INDENT{\textbf{Initialization:}}
	% \STATE $correct_u \leftarrow \Pi$
	\STATE $crashed_u \leftarrow \emptyset$
	\STATE $passiv_u \leftarrow \Pi$

\ENDINDENT \BLANK

\INDENT{\textbf{In each round $t$:}}
	\INDENT{$S_u^t$}
		\IF{$passiv_u = \Pi$}
			\STATE send $\bot$ to all
		\ELSE
			\STATE send $\langle crashed_u \rangle$ to all
		\ENDIF
	\ENDINDENT \BLANK
	\INDENT{$T_u^t$}
		\STATE $crashed_u \leftarrow passiv_u \setminus HO(u, t) \setminus \bigcup\limits_{v \in HO(u,t)} crashed_v(t-1)$ \label{line:detect}
		\IF{no null, no $\bot$ received and $crashed_u = \emptyset$ and $\bigcup\limits_{v \in HO(u,t)} crashed_v(t-1) = \emptyset$}
			\STATE fire 
		\ENDIF
		\STATE $passiv_u \leftarrow $ set of node which sent null
	\ENDINDENT 
\ENDINDENT 

\caption{The non-uniform firing-squad algorithm} \label{algo:R}
\end{distribalgo}

\end{algorithm}

\begin{theorem}
	The non-uniform firing-squad algorithm solves non-uniform synchronization problem.
\end{theorem}
\begin{proof}
	We first prove safety. We assume that a correct node $u$ fires in round $t$.
	By contradiction, we assume that a correct node $v$ does not fire in rount $t$.
	Then, one of the following cases apply :
	\begin{itemize}
		\item $v$ received a null (or a $\bot$) from a node $w$.
			Since $u$ fired, $u$ must not have received a null (or a $\bot$) from $w$. That means that $w$ crashed in round $t$, and $w \in passiv_u(t-1) \setminus HO(u, t)$.
			Then $crashed_u(t) \neq \emptyset$ and $u$ could not have fired.
		\item $v$ witnessed the crash of a node $w$ in round $t$.
			If $u$ witnessed that crash, too, $u$ could not have fired.
			Otherwise, $u$ received null or $\bot$.
			In any case, $u$ could not have fired.
		\item $v$ received a non-empty message from $z$ containing $w$. 
			That means that :
			\begin{itemize}
				\item $z$ received a null from $w$ in round $t-2$ but not in round $t-1$. Then $w$ crashed either in round $t-2$ or in round $t-1$.
				\item $z$ did not receive in round $t-1$ a message containing $w$. See~\ref{line:detect}.
			\end{itemize}
		\begin{itemize}
			\item In round $t-1$, $w$ managed to send its null message to $u$, then $w \in passiv_u(t-1)$ and $w \in crashed_u(t)$.
				That contradict the fact that $u$ fired in round $t$.
			\item Otherwise $u$ did not receive null from $w$ in round $t-1$. Then $w \in crashed_u(t-1)$. 

			\end{itemize}
		\end{itemize}
		\item $v$ heart about the crash of a node $w$ which happened in round $t-1$.
	\end{itemize}
	That means that there exist a node $w$ which sent a null in round $t-1$.

\end{proof}


\end{document}
